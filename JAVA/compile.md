# JAVA 컴파일 과정


자바는 컴파일 단계와 런타임 단계로 나누어 프로그램이 실행됩니다. 각각의 단계에서 중요한 컴포넌트와 프로세스가 포함되며, 이를 이해하면 자바의 플랫폼 독립성 및 성능 최적화 방식을 더 잘 이해할 수 있습니다.

---

## 컴파일 과정이 필요한 이유

1. 기계가 이해할 수 있는 코드로 변환하기 위해(운영체제 및 하드웨어에 맞는 코드로 변환)
2. 코드 최적화 및 성능 개선을 위해
3. 구문 및 오류 검사를 위해

## 자바의 컴파일이 다른 언어와 다른 점

자바는 컴파일된 바이트 코드를 실행하는 런타임 환경을 사용합니다. 이는 자바의 플랫폼 독립성을 제공하며, 다양한 운영체제에서 실행이 가능

실행 환경별로 다른 바이트코드가 필요한 것이 아니라, JVM이라는 가상 머신을 통해 실행되기 때문에, 운영체제에 종속되지 않음

또한, 추가적으로 자바는 자동으로 메모리 관리를 지원함
---

## 컴파일 타임 환경

컴파일 타임에는 소스 코드가 바이트 코드로 변환됩니다. 이는 자바 프로그램 실행을 준비하는 과정입니다.

### 1. 자바 클래스 파일 (.java)
자바 소스 코드는 일반적으로 `.java` 확장자를 가진 파일에 작성됩니다. 예를 들어, `HelloWorld.java`라는 파일에는 `public class HelloWorld`와 같은 클래스 정의가 포함됩니다.

### 2. 자바 컴파일러 (javac)
`javac`는 자바 컴파일러로, `.java` 파일을 컴파일하여 자바 바이트 코드 파일(.class)을 생성합니다. 컴파일 과정은 다음과 같은 단계로 이루어집니다:

1. **파싱 (Parsing):**
   - 소스 코드를 읽어들여 토큰(token)으로 분리합니다.
   - 토큰을 기반으로 문법 구조를 분석하여 **추상 구문 트리 (AST, Abstract Syntax Tree)** 를 생성합니다.

    ```java
        int add(int a, int b) {
        return a + b;
        }
    ```
    
    #### 파싱 단계
    ```

    int : (키워드)

    add : (함수 이름)

    (, int, a, ,, int, b, ) : (매개변수)

    {, return, a, +, b, ;, }  : (본문)

    ```
    
    추상 구문 트리 (AST): 파싱 결과로 생성되는 트리는 다음과 같은 계층 구조를 가집니다:
    ```

    FunctionDeclaration
    ├── ReturnType: int
    ├── FunctionName: add
    ├── Parameters
    │   ├── Parameter
    │   │   ├── Type: int
    │   │   └── Name: a
    │   └── Parameter
    │       ├── Type: int
    │       └── Name: b
    └── Body
        └── ReturnStatement
            └── Expression
                ├── LeftOperand: a
                ├── Operator: +
                └── RightOperand: b
    ```

    이 트리는 코드 구조를 계층적으로 표현하며, 컴파일러가 의미 분석과 코드 생성 단계에서 사용합니다.


2. **구문 및 의미 분석 (Semantic Analysis):**
   - AST를 검사하여 문법 오류와 의미론적 오류를 찾아냅니다.
   - 변수 선언, 타입 체크 등 프로그램의 의미를 확인합니다.

3. **중간 코드 생성:**
   - 컴파일러는 AST를 바이트 코드로 변환합니다. 바이트 코드는 플랫폼에 독립적인 명령어 집합입니다.

4. **최적화 (Optimization):**
   - 컴파일러는 필요에 따라 코드를 최적화하여 더 효율적인 바이트 코드를 생성합니다.

```bash
javac HelloWorld.java
```
이 명령어는 `HelloWorld.class` 파일을 생성합니다.

### 3. 자바 바이트 코드 (.class)
바이트 코드는 자바 가상 머신(JVM)에서 실행되는 중간 코드 형태입니다. 바이트 코드는 플랫폼에 독립적이며, 이식성이 뛰어납니다.

---

## 런타임 환경

런타임 환경에서는 컴파일된 바이트 코드가 실제로 실행됩니다. 자바의 런타임 환경은 플랫폼 독립성과 성능 최적화의 핵심입니다.

### 1. JVM (Java Virtual Machine)
자바 가상 머신은 바이트 코드를 실행하는 역할을 합니다. JVM은 운영체제와 하드웨어에 종속되지 않으며, 다음과 같은 주요 기능을 제공합니다:

- **클래스 로더 (Class Loader):** 컴파일된 `.class` 파일을 메모리에 로드합니다.
- **바이트 코드 검증:** 바이트 코드의 유효성을 검사하여 보안과 안정성을 보장합니다.
- **인터프리터:** 바이트 코드를 한 줄씩 읽어 명령어를 실행합니다.

자바의 플랫폼 독립성은 "Write Once, Run Anywhere" 철학에 기반하며, JVM 덕분에 컴파일된 바이트 코드를 다양한 운영체제에서 실행할 수 있습니다.

### 2. JIT (Just-In-Time) 컴파일러
JIT 컴파일러는 JVM의 성능을 최적화하는 구성 요소로, 런타임 중 바이트 코드를 네이티브 머신 코드로 변환합니다. 이를 통해 반복 실행되는 코드를 더 빠르게 실행할 수 있습니다.

- **초기 실행 시:** JVM은 바이트 코드를 인터프리터로 실행합니다.
- **JIT 컴파일 후:** JIT 컴파일러가 자주 실행되는 코드를 기계어로 변환하여 실행 속도를 높입니다.

JIT 컴파일러 덕분에 자바는 인터프리터 기반 언어의 이식성과 컴파일 기반 언어의 성능을 동시에 제공합니다.

---

## 요약
- 컴파일 타임에는 `javac` 컴파일러가 자바 소스 코드를 바이트 코드로 변환합니다.
- 런타임에는 JVM이 바이트 코드를 실행하며, JIT 컴파일러가 성능을 최적화합니다.
- 자바는 플랫폼 독립성과 성능을 모두 제공하는 강력한 언어입니다.

