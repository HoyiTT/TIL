# 교착상태(deadlock)

## 교착상태란?

두 개 이상의 작업이 서로 상대방의 작업이 끝나기만을 기라디고 있어 결과적으로 아무것도 완료되지 못하는 상태를 의미.

## 교착상태의 필요조건

1. 상호배제(Mutual Exclusion): 자원은 한 번에 한 프로세스만 사용할 수 있어야 한다.
2. 점유대기(Hold and Wait): 프로세스가 할당된 자원을 가진 상태에서 다른 자원을 기다리고 있다.
3. 비선점(No Preemption): 다른 프로세스에 할당된 자원을 강제로 빼앗을 수 없다.
4. 순환대기(Circular Wait): 프로세스의 집합 {P0, P1, P2, ..., Pn}에서 P0는 P1이 점유한 자원을 대기하고, P1은 P2가 점유한 자원을 대기하고, P2는 Pn이 점유한 자원을 대기하고, Pn은 P0이 점유한 자원을 요구해야 한다.

## 해결 방법

1. 예방(Prevention)

→ 4가지 조건 중 하나 이상을 사전에 차단
	•	점유와 대기 차단: 자원을 한 번에 모두 할당받게 강제
→ synchronized 블록 안에서 모든 자원 한번에 얻기
	•	비선점성 차단: 필요한 자원이 없으면 점유 중인 자원 반납 후 재시도

⸻

2. 회피(Avoidance)

→ 교착상태 발생 가능성을 미리 계산해서 피해감
	•	은행가 알고리즘(Banker’s Algorithm) 사용 (실무에서는 거의 안 씀)
	•	현실에선 성능 문제로 잘 안 쓰임

⸻

3. 발견(Detection)

→ 교착상태가 발생했는지 감시하고, 발생 시 해결
	•	주기적으로 자원 그래프 검사
	•	교착 상태 탐지 시 강제 종료, 롤백 등으로 처리

⸻

4. 회복(Recovery)

→ 교착상태 발생 후, 해결하기 위해 개입
	•	트랜잭션 기반 시스템: 특정 트랜잭션을 강제 롤백
	•	멀티스레딩: 특정 스레드 interrupt 또는 자원 회수